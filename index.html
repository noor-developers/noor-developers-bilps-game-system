<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>NOOR Game Management System (v13 - Dinamik stol boshqaruvi)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <link rel="stylesheet" href="src/css/styles.css?v=20.0" />
  <link rel="stylesheet" href="src/css/responsive.css?v=20.0" />
  
</head>
<body>
  
  <div id="snowfallContainer"></div>

  <!-- YANGI LOGIN DIZAYNI -->
  <div class="login-screen" id="loginScreen">
    <div class="login-container">
      <div class="login-header">
        <div class="logo">NOOR GMS</div>
        <h1>Game Management System</h1>
      </div>
      <div class="login-box">
        <div class="login-form" id="loginFormDiv">
          <h2>ğŸ” Tizimga kirish</h2>
          <div class="input-group">
            <input type="text" id="loginUsername" placeholder="ğŸ‘¤ Username (kichik harflar)" style="text-transform: lowercase;" />
          </div>
          <div class="input-group">
            <input type="password" id="loginPassword" placeholder="ğŸ”‘ Parol" />
          </div>
          <button id="loginButton" class="login-btn" onclick="login()">Kirish</button>
          <div id="loginStatus" class="login-status"></div>
          <div class="text-center mt-15 text-muted">
            Akkauntingiz yo'qmi? <a href="#" onclick="showRegisterForm(); return false;" class="link-accent">Ro'yxatdan o'tish</a>
          </div>
        </div>
        <div class="login-form hidden" id="registerFormDiv">
          <h2>ğŸ“ Ro'yxatdan o'tish</h2>
          
          <h3 class="section-subtitle">ğŸ‘¤ Akkaunt</h3>
          <div class="input-group">
            <input type="text" id="registerUsername" placeholder="ğŸ‘¤ Username: faqat a-z, 0-9, _ (masalan: noor_club_01)" pattern="[a-z0-9_]+" title="Faqat kichik harflar (a-z), raqamlar (0-9) va pastki chiziq (_) ishlatish mumkin" style="text-transform: lowercase;" />
            <small style="color: #6b7280; font-size: 12px; margin-top: 5px; display: block;">âœ“ Kichik harflar: a-z | âœ“ Raqamlar: 0-9 | âœ“ Pastki chiziq: _</small>
          </div>
          
          <h3 class="section-subtitle">ğŸ¢ Klub ma'lumotlari</h3>
          <div class="input-group">
            <input type="text" id="registerClubName" placeholder="ğŸ® Klub nomi (masalan: NOOR Game Club)" />
          </div>
          <div class="input-group">
            <input type="text" id="registerOwnerName" placeholder="ğŸ‘¤ Egasi ismi" />
          </div>
          <div class="input-group">
            <input type="tel" id="registerPhone" placeholder="ğŸ“± Telefon (+998901234567)" />
          </div>
          <div class="input-group">
            <input type="text" id="registerAddress" placeholder="ğŸ“ Manzil (ixtiyoriy)" />
          </div>
          
          <h3 class="section-subtitle">ğŸ” Parol yaratish</h3>
          <div class="input-group">
            <input type="password" id="registerPassword" placeholder="ğŸ”‘ Parol (kamida 6 ta belgi)" />
          </div>
          <div class="input-group">
            <input type="password" id="registerConfirmPassword" placeholder="âœ… Parolni tasdiqlash" />
          </div>
          
          <button class="login-btn" onclick="register()">Ro'yxatdan o'tish</button>
          <div class="text-center mt-15 text-muted">
            Akkauntingiz bormi? <a href="#" onclick="showLoginForm(); return false;" class="link-accent">Kirish</a>
          </div>
        </div>
        <div class="login-footer">
          <div class="clock" id="loginClock">00:00:00</div>
          <div class="date" id="loginDate">Yakshanba, 01.01.2024</div>
        </div>
      </div>
    </div>
  </div>
  
  <div id="newYearBanner"></div>

  <div class="topbar">
    <div class="flex-column-5">
      <div class="topbar-brand">
        <div class="club-name" id="clubNameDisplay"></div>
        <div class="brand-subtitle">Created by Noor developers</div>
      </div>
      <div id="clubInfo" class="club-info-banner hidden"></div>
    </div>
    <nav class="nav">
      <button class="active" data-page="billiard">Billiard</button>
      <button data-page="playstation">PlayStation</button>
      <button data-page="bar">Bar</button>
      <button data-page="debtors">Qarzdorlar</button>
      <button data-page="history">Tarix</button>
      <button data-page="log">Log</button>
    </nav>
    <div class="topbar-right">
      <button class="notes-topbar-btn" onclick="openQueueModal()" title="Navbat olish">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;">
          <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="8.5" cy="7" r="4"></circle>
          <polyline points="17 11 19 13 23 9"></polyline>
        </svg>
        <span>Navbat</span>
      </button>
      
      <button class="notes-topbar-btn" onclick="openNotesModal()" title="Zametkalar">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        <span>Zametkalar</span>
      </button>
      
      <div class="clock-container">
        <div class="clock" id="mainClock">00:00:00</div>
        <div class="date" id="currentDate"></div>
      </div>
      
      <!-- User Profile Dropdown -->
      <div class="profile-dropdown hidden" id="userProfile">
        <button class="profile-btn" onclick="toggleProfileMenu()" id="profileBtn">
          <div class="user-avatar" id="userAvatar"></div>
          <div class="user-info">
            <div class="user-name" id="userName">User</div>
            <div class="user-role">Xodim</div>
          </div>
          <span class="dropdown-arrow">â–¼</span>
        </button>
        
        <div class="profile-menu hidden" id="profileMenu">
          <!-- Balanslar -->
          <div class="profile-menu-section">
            <div class="profile-menu-title">ğŸ’° Balanslar</div>
            <div class="balance-item">
              <span>ğŸ’µ Naqd:</span>
              <strong id="profileCashBalance">0 so'm</strong>
            </div>
            <div class="balance-item">
              <span>ğŸ’³ O'tkazma:</span>
              <strong id="profileTransferBalance">0 so'm</strong>
            </div>
            <div class="balance-item">
              <span>ğŸ”´ Qarzlar:</span>
              <strong id="profileDebtBalance">0 so'm</strong>
            </div>
          </div>
          
          <div class="profile-menu-divider"></div>
          
          <!-- Smena -->
          <div class="profile-menu-section">
            <div class="profile-menu-title">â° Smena</div>
            <div class="shift-status-item" id="profileShiftStatus">
              <span class="shift-indicator-small">âš« Yopiq</span>
            </div>
            <button class="profile-menu-btn" onclick="toggleShift(); closeProfileMenu()" id="profileShiftBtn">
              <span>ğŸ”„</span> Smena ochish
            </button>
          </div>
          
          <div class="profile-menu-divider"></div>
          
          <!-- Obuna -->
          <div class="profile-menu-section">
            <div class="profile-menu-title">â­ Obuna</div>
            <div class="subscription-info" id="subscriptionInfo">
              <div class="subscription-status">
                <span class="subscription-badge" id="subscriptionBadge">ğŸ”’ Faol emas</span>
              </div>
              <div class="subscription-details" id="subscriptionDetails">
                <small>Obuna tugash sanasi: <strong id="subscriptionEndDate">--</strong></small>
              </div>
            </div>
            <button class="profile-menu-btn" onclick="openSubscriptionModal(); closeProfileMenu()">
              <span>ğŸ’</span> Obunani uzaytirish
            </button>
          </div>
          
          <div class="profile-menu-divider"></div>
          
          <!-- Amallar -->
          <button class="profile-menu-btn" onclick="openSettingsFromProfile(); closeProfileMenu()">
            <span>âš™ï¸</span> Sozlamalar
          </button>
          
          <button class="profile-menu-btn profile-menu-logout" onclick="logout(); closeProfileMenu()">
            <span>ğŸšª</span> Chiqish
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="main-container">
    <div class="left-panel">
      <div class="stats-section">
        <div class="section-title">ğŸ“Š Faol sessiyalar</div>
        <div class="active-sessions" id="activeSessions">
          <div class="text-center color-dim">Faol sessiya yo'q</div>
        </div>
      </div>
      
      <div class="stats-section">
        <div class="section-title">ğŸ’µ Smenada (Jami Tushum)</div>
        <div class="stat-item">
          <span>Billiard-1:</span>
          <span class="stat-value" id="statB1">0 so'm</span>
        </div>
        <div class="stat-item">
          <span>Billiard-2:</span>
          <span class="stat-value" id="statB2">0 so'm</span>
        </div>
        <div class="stat-item">
          <span>PS4 Pro:</span>
          <span class="stat-value" id="statPS4">0 so'm</span>
        </div>
        <div class="stat-item">
          <span>PS5 Slim:</span>
          <span class="stat-value" id="statPS5">0 so'm</span>
        </div>
        <div class="stat-item">
          <span>Bar:</span>
          <span class="stat-value" id="statBar">0 so'm</span>
        </div>
        <div class="stat-item stat-highlight">
          <span class="fw-800">JAMI TUSHUM:</span>
          <span class="stat-value" id="statTotal">0 so'm</span>
        </div>
      </div>
      
      <div class="debtors-preview">
        <div class="section-title">ğŸ”´ Top 10 qarzdorlar</div>
        <div id="topDebtorsList">
          <div class="text-center color-dim">Qarzdor yo'q</div>
        </div>
      </div>
    </div>

    <div class="content-area" id="contentArea"></div>

    <div class="right-panel">
      <div class="section-title">ğŸ§¾ Cheklar</div>
      <div class="receipt-filter-container">
        <select class="receipt-filter-dropdown" id="receiptTimeFilter" onchange="applyReceiptFilters()">
          <option value="today" selected>Bugun</option>
          <option value="7days">7-kunlik</option>
          <option value="all">Barchasi</option>
          <option value="bar">Bar</option>
        </select>
        <input type="date" class="receipt-date-input" id="receiptDateSearch" onchange="applyReceiptFilters()" placeholder="Sana">
      </div>
      <div id="receiptsList"></div>
    </div>
  </div>

  <!-- Modal oynalari -->
  <div class="modal" id="startModal">
    <div class="modal-content">
      <div class="modal-header">â±ï¸ Sessiyani boshlash</div>
      <div class="modal-text" id="startModalTable"></div>
      <div class="modal-buttons">
        <button class="modal-btn" onclick="selectInputType('time')">
          <div class="icon-xl">â°</div>
          <div>Vaqt bo'yicha (minut)</div>
        </button>
        <button class="modal-btn" onclick="selectInputType('money')">
          <div class="icon-xl">ğŸ’°</div>
          <div>Pul bo'yicha (so'm)</div>
        </button>
      </div>
      <div class="modal-close">
        <button class="btn btn-danger" onclick="closeModal('startModal')">Yopish</button>
      </div>
    </div>
  </div>
  
  <!-- Qolgan modal oynalari -->
  <div class="modal" id="inputModal">
    <div class="modal-content">
      <div class="modal-header" id="inputModalTitle"></div>
      <input type="text" class="modal-input" id="inputModalValue" placeholder="Qiymat kiriting" title="Qiymat kiriting" />
      <div class="modal-close">
        <button class="btn btn-success" onclick="confirmInput()">Tasdiqlash</button>
        <button class="btn btn-danger" onclick="closeModal('inputModal')">Bekor qilish</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="paymentModal">
    <div class="modal-content">
      <div class="modal-header" id="paymentModalHeader">ğŸ’³ To'lov</div>
      <div class="modal-text" id="paymentDetails"></div>
      
      <div class="modal-buttons modal-grid-2 mb-20">
        <button class="modal-btn active" id="payBtnCash" onclick="selectPaymentType('cash', this)">ğŸ’µ Naqd</button>
        <button class="modal-btn" id="payBtnTransfer" onclick="selectPaymentType('transfer', this)">ğŸ’³ O'tkazma</button>
      </div>
      
      <div class="modal-close modal-close-grid">
        <button class="btn btn-success grid-span-full" onclick="confirmPayment()">âœ… To'lash</button>
        <button class="btn btn-danger" id="paymentModalDebtBtn" onclick="addToDebt()">ğŸ”´ Qarzga</button>
        <button class="btn btn-primary" onclick="closePaymentModal(true)">Bekor qilish</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="selectDebtorModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ”´ Qarzga yozish</div>
      <div class="modal-text">Mavjud qarzdorlardan birini tanlang yoki yangi qo'shing:</div>
      <div class="modal-buttons scrollable-list" id="existingDebtorsList">
        </div>
      <button class="btn btn-primary full-width mt-15" onclick="openNewDebtorModal()">+ Yangi Qarzdor Qo'shish</button>
      <div class="modal-close">
        <button class="btn btn-danger" onclick="closeModal('selectDebtorModal'); openModal('paymentModal');">Orqaga</button>
      </div>
    </div>
  </div>

  <div class="modal" id="newDebtorModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ“ Yangi Qarzdor Ismi</div>
      <input type="text" class="modal-input" id="newDebtorName" placeholder="Qarzdor ismini kiriting" />
      <div class="modal-close">
        <button class="btn btn-success" onclick="confirmDebtName(null)">Saqlash</button>
        <button class="btn btn-danger" onclick="closeModal('newDebtorModal'); openModal('selectDebtorModal');">Orqaga</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="confirmModal">
    <div class="modal-content">
      <div class="modal-header">âš ï¸ Tasdiqlash</div>
      <div class="modal-text" id="confirmText"></div>
      <div class="modal-close">
        <button class="btn btn-success" onclick="confirmAction()">Ha</button>
        <button class="btn btn-danger" onclick="closeModal('confirmModal')">Yo'q</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="notificationModal">
    <div class="modal-content">
      <div class="modal-header">â„¹ï¸ Xabar</div>
      <div class="modal-text" id="notificationText"></div>
      <div class="modal-close">
        <button class="btn btn-primary" onclick="closeModal('notificationModal')">OK</button>
      </div>
    </div>
  </div>

  <div class="modal" id="promptModal">
    <div class="modal-content">
      <div class="modal-header" id="promptHeader">ğŸ“ Ma'lumot kiriting</div>
      <div class="modal-text" id="promptText"></div>
      <input type="text" id="promptInput" class="modal-input" />
      <div class="modal-close">
        <button class="btn btn-success" onclick="confirmPrompt()">OK</button>
        <button class="btn btn-secondary" onclick="closeModal('promptModal')">Bekor qilish</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="transferModal">
    <div class="modal-content">
      <div class="modal-header text-warning">ğŸ’³ O'tkazma ma'lumotlari</div>
      <div class="modal-text">
        <div class="fw-700">Karta raqami:</div>
        <div class="text-xl text-primary" id="transferCardNumber"></div>
      </div>
      <div class="modal-text color-danger fw-700">
        Iltimos, o'tkazma summasi (<span id="transferAmountDisplay">0</span> so'm) kelib tushganiga ishonch hosil qiling!
      </div>
      <div class="modal-close">
        <button class="btn btn-success" onclick="finalizePayment('transfer')">âœ… Tushunarli</button>
      </div>
    </div>
  </div>

  <div class="modal" id="alarmModal">
    <div class="modal-content modal-danger">
      <div class="modal-header text-white">ğŸš¨ VAQT TUGAYAPTI!</div>
      <div class="modal-text text-white text-xl" id="alarmText"></div>
      <div class="modal-close">
        <button class="btn btn-warning" onclick="closeModal('alarmModal')">OK</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="barProductModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ¹ Kimga sotiladi?</div>
      <div class="modal-buttons" id="barTargetButtons"></div>
      <button class="btn btn-success full-width mt-10" onclick="sellToCustomer()">Mijozga sotish</button>
      <div class="modal-close">
        <button class="btn btn-danger" onclick="closeModal('barProductModal')">Yopish</button>
      </div>
    </div>
  </div>

  <div class="modal" id="settingsPasswordModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ”’ Sozlamalar paroli</div>
      <input type="password" class="modal-input" id="settingsPasswordInput" placeholder="Parolni kiriting" />
      <div class="modal-close">
        <button class="btn btn-success" onclick="checkSettingsPassword()">Kirish</button>
        <button class="btn btn-danger" onclick="closeModal('settingsPasswordModal')">Bekor qilish</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="payDebtModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ’° Qarzni to'lash</div>
      <div class="modal-text" id="payDebtDetails"></div>
      <input type="number" class="modal-input" id="payDebtAmount" placeholder="To'lanadigan summa" />
      <div class="modal-buttons modal-grid-3">
        <button class="btn btn-blue" onclick="confirmPayDebt('cash')">ğŸ’µ Naqd</button>
        <button class="btn btn-warning" onclick="confirmPayDebt('transfer')">ğŸ’³ O'tkazma</button>
      </div>
      <div class="modal-close">
        <button class="btn btn-danger" onclick="closeModal('payDebtModal')">Bekor qilish</button>
      </div>
    </div>
  </div>
  
  <div class="modal" id="deleteDebtorModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ”’ Qarzdorni o'chirish</div>
      <div class="modal-text">Qarzdorni o'chirish uchun sozlamalar parolini kiriting:</div>
      <input type="password" class="modal-input" id="deleteDebtorPassword" placeholder="Parolni kiriting" />
      <div class="modal-close">
        <button class="btn btn-danger" onclick="confirmDeleteDebtor()">O'chirish</button>
        <button class="btn btn-primary" onclick="closeModal('deleteDebtorModal')">Bekor qilish</button>
      </div>
    </div>
  </div>

  <div class="modal" id="exportLogPasswordModal">
    <div class="modal-content">
      <div class="modal-header">ğŸ”’ Log Eksport</div>
      <div class="modal-text">Log faylini eksport qilish uchun Sozlamalar parolini kiriting:</div>
      <input type="password" class="modal-input" id="exportLogPassword" placeholder="Parolni kiriting" />
      <div class="modal-close">
        <button class="btn btn-success" onclick="confirmLogExport()">Eksport</button>
        <button class="btn btn-danger" onclick="closeModal('exportLogPasswordModal')">Bekor qilish</button>
      </div>
    </div>
  </div>

  <!-- Subscription Modal -->
  <div id="subscriptionModal" class="modal">
    <div class="modal-content">
      <h3>â­ Obuna boshqaruvi</h3>
      <p>Obunangizni faollashtiring yoki uzaytiring</p>
      
      <div class="subscription-plans">
        <div class="plan-card">
          <div class="plan-header">
            <h4>ğŸ“… Oylik</h4>
            <div class="plan-price">150,000 so'm</div>
          </div>
          <ul class="plan-features">
            <li>âœ… 30 kun obuna</li>
            <li>âœ… Barcha funksiyalar</li>
            <li>âœ… Texnik yordam</li>
          </ul>
          <button class="btn btn-primary full-width" onclick="activateSubscription(30)">Sotib olish</button>
        </div>
        
        <div class="plan-card plan-popular">
          <div class="plan-badge">â­ Ommabop</div>
          <div class="plan-header">
            <h4>ğŸ“… 3 oylik</h4>
            <div class="plan-price">400,000 so'm</div>
            <div class="plan-discount">11% tejash</div>
          </div>
          <ul class="plan-features">
            <li>âœ… 90 kun obuna</li>
            <li>âœ… Barcha funksiyalar</li>
            <li>âœ… Texnik yordam</li>
            <li>âœ… Maxsus bonuslar</li>
          </ul>
          <button class="btn btn-success full-width" onclick="activateSubscription(90)">Sotib olish</button>
        </div>
        
        <div class="plan-card">
          <div class="plan-header">
            <h4>ğŸ“… Yillik</h4>
            <div class="plan-price">1,500,000 so'm</div>
            <div class="plan-discount">17% tejash</div>
          </div>
          <ul class="plan-features">
            <li>âœ… 365 kun obuna</li>
            <li>âœ… Barcha funksiyalar</li>
            <li>âœ… Maxsus texnik yordam</li>
            <li>âœ… Premium bonuslar</li>
          </ul>
          <button class="btn btn-primary full-width" onclick="activateSubscription(365)">Sotib olish</button>
        </div>
      </div>
      
      <div class="modal-footer-center">
        <button class="btn btn-secondary" onclick="closeModal('subscriptionModal')">Yopish</button>
      </div>
    </div>
  </div>

  <!-- Zametkalar Modal -->
  <div class="modal" id="notesModal">
    <div class="modal-content notes-modal-content">
      <div class="modal-header">
        <h2>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:22px;height:22px;vertical-align:middle;margin-right:8px;">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
          Zametkalar
        </h2>
        <button class="close-btn" onclick="closeModal('notesModal')">Ã—</button>
      </div>
      
      <div class="modal-body">
        <div class="notes-container">
          <div class="notes-list" id="notesList"></div>
          <div class="notes-editor">
            <input type="text" id="noteTitle" class="modal-input" placeholder="Sarlavha..." />
            <textarea id="noteContent" class="notes-textarea" placeholder="Zametka matni..."></textarea>
            <div class="notes-actions">
              <button class="btn btn-primary" onclick="saveNote()">Saqlash</button>
              <button class="btn btn-secondary" onclick="clearNoteEditor()">Tozalash</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sozlamalar Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content settings-modal-content">
      <div class="modal-header">
        <h2>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;">
            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
          Sozlamalar
        </h2>
      </div>
      
      <div class="modal-body">
        <div class="settings-wrapper">
          <div>
            <!-- Profil ma'lumotlari -->
            <div class="settings-section">
              <h3 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                Profil ma'lumotlari
              </h3>
          <div class="input-group">
            <label>ğŸ†” Noyob ID (o'zgarmas)</label>
            <input type="text" id="settingsUniqueId" class="modal-input" readonly title="Unique ID" placeholder="Yuklanmoqda..." style="font-family: monospace; font-weight: bold; color: #2563eb;" />
          </div>
          <div class="input-group">
            <label>Foydalanuvchi nomi</label>
            <input type="text" id="settingsUsername" class="modal-input" readonly title="Foydalanuvchi" placeholder="Foydalanuvchi" />
          </div>
          <div class="input-group">
            <label>Club nomi</label>
            <input type="text" id="settingsClubName" class="modal-input" readonly title="Club nomi" placeholder="Club nomi" />
          </div>
        </div>

            <!-- Parol o'zgartirish -->
            <div class="settings-section">
              <h3 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                Xavfsizlik
              </h3>
          <div class="input-group">
            <label>Joriy parol</label>
            <input type="password" id="settingsCurrentPassword" class="modal-input" placeholder="Joriy parolni kiriting" />
          </div>
          <div class="input-group">
            <label>Yangi parol</label>
            <input type="password" id="settingsNewPassword" class="modal-input" placeholder="Yangi parol" />
          </div>
          <div class="input-group">
            <label>Yangi parolni tasdiqlash</label>
            <input type="password" id="settingsConfirmPassword" class="modal-input" placeholder="Yangi parolni qayta kiriting" />
          </div>
          <button class="btn btn-warning full-width" onclick="changePassword()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:18px;height:18px;vertical-align:middle;margin-right:8px;"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
            Parolni o'zgartirish
          </button>
            </div>
          </div>

          <div>
            <!-- Ma'lumotlarni boshqarish -->
            <div class="settings-section">
              <h3 class="section-title">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
                Ma'lumotlarni boshqarish
              </h3>
          <div class="settings-actions">
            <button class="btn btn-secondary full-width" onclick="exportData()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:18px;height:18px;vertical-align:middle;margin-right:8px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
              Ma'lumotlarni yuklash (JSON)
            </button>
            <button class="btn btn-warning full-width" onclick="clearLocalStorage()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:18px;height:18px;vertical-align:middle;margin-right:8px;"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
              Keshni tozalash
            </button>
            <button class="btn btn-primary full-width" onclick="openTableManagementModal()">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:18px;height:18px;vertical-align:middle;margin-right:8px;">
                <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
                <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
                <line x1="6" y1="6" x2="6.01" y2="6"></line>
                <line x1="6" y1="18" x2="6.01" y2="18"></line>
              </svg>
              Stollarni boshqarish
            </button>
              </div>
            </div>

            <!-- Versiya -->
            <div class="settings-section">
              <div class="version-info">
                <small>NOOR GMS v20.0 (Secure Auth + AES-256) | Created by Noor developers</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeModal('settingsModal')">Yopish</button>
        <button class="btn btn-primary" onclick="saveSettings()">
          <span>ğŸ’¾</span> Saqlash
        </button>
      </div>
    </div>
  </div>

    <script>
      // Login screen clock updater
      console.log('ğŸ•’ Login clock init');
      
      function updateLoginClock() {
        const now = new Date();
        const days = ['Yakshanba', 'Dushanba', 'Seshanba', 'Chorshanba', 'Payshanba', 'Juma', 'Shanba'];
        const months = ['Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'Iyun', 'Iyul', 'Avgust', 'Sentabr', 'Oktabr', 'Noyabr', 'Dekabr'];
        const day = now.getDate().toString().padStart(2, '0');
        const month = (now.getMonth() + 1).toString().padStart(2, '0');

        const loginClockEl = document.getElementById('loginClock');
        if (loginClockEl) {
          loginClockEl.textContent = now.toLocaleTimeString('uz-UZ', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        const loginDateEl = document.getElementById('loginDate');
        if (loginDateEl) {
          loginDateEl.textContent = `${days[now.getDay()]}, ${day}.${month}.${now.getFullYear()}`;
        }
      }

      setInterval(updateLoginClock, 1000);
      updateLoginClock();
    </script>

    <!-- Table Management Modal -->
    <!-- Queue Management Modal -->
    <div class="modal" id="queueModal">
      <div class="modal-content queue-modal">
        <div class="modal-header">
          <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="8.5" cy="7" r="4"></circle>
              <polyline points="17 11 19 13 23 9"></polyline>
            </svg>
            Navbat boshqaruvi
          </h2>
        </div>
        
        <div class="modal-body">
          <!-- Add Customer Section -->
          <div class="add-table-section">
            <h3 class="section-subtitle">â• Navbatga qo'shish</h3>
            <div class="queue-add-form">
              <input type="text" id="queueCustomerName" class="modal-input" placeholder="Mijoz ismi *" />
              <input type="tel" id="queueCustomerPhone" class="modal-input" placeholder="Telefon (ixtiyoriy)" />
              <select id="queueTableType" class="modal-input">
                <option value="billiard">ğŸ± Billiard</option>
                <option value="ps4">ğŸ® PlayStation 4</option>
                <option value="ps5">ğŸ® PlayStation 5</option>
              </select>
              <button class="btn btn-success" onclick="addCustomerFromModal()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;vertical-align:middle;margin-right:4px;">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Qo'shish
              </button>
            </div>
          </div>

          <!-- Queue List -->
          <div class="tables-list-section">
            <div style="display: flex; justify-content: flex-end; margin-bottom: 10px;">
              <button class="btn btn-danger" onclick="clearQueue()" style="padding: 8px 16px; font-size: 14px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;vertical-align:middle;margin-right:4px;">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
                Navbatni tozalash
              </button>
            </div>
            <div id="queueListContainer" class="queue-list"></div>
          </div>
        </div>
        
        <div class="modal-footer-center">
          <button class="btn btn-secondary" onclick="closeModal('queueModal')">Yopish</button>
        </div>
      </div>
    </div>

    <div class="modal" id="tableManagementModal">
      <div class="modal-content table-management-modal">
        <div class="modal-header">
          <h2>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:20px;height:20px;vertical-align:middle;margin-right:8px;">
              <rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect>
              <rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect>
              <line x1="6" y1="6" x2="6.01" y2="6"></line>
              <line x1="6" y1="18" x2="6.01" y2="18"></line>
            </svg>
            Stollarni boshqarish
          </h2>
        </div>
        
        <div class="modal-body">
          <!-- Add New Table Section -->
          <div class="add-table-section">
            <h3 class="section-subtitle">â• Yangi stol qo'shish</h3>
            <div class="add-table-form">
              <select id="newTableType" class="modal-input">
                <option value="billiard">ğŸ± Billiard</option>
                <option value="ps4">ğŸ® PlayStation 4</option>
                <option value="ps5">ğŸ® PlayStation 5</option>
              </select>
              <input type="text" id="newTableName" class="modal-input" placeholder="Stol nomi (masalan: Billiard 1)" />
              <input type="number" id="newTablePrice" class="modal-input" placeholder="Narx (soatiga, masalan: 35000)" min="0" step="1000" />
              <button class="btn btn-success" onclick="addTableFromModal()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;vertical-align:middle;margin-right:4px;">
                  <line x1="12" y1="5" x2="12" y2="19"></line>
                  <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                Qo\'shish
              </button>
            </div>
          </div>

          <!-- Tables List -->
          <div class="tables-list-section">
            <h3 class="section-subtitle">ğŸ“‹ Mavjud stollar</h3>
            <div id="tablesListContainer" class="tables-list"></div>
          </div>
        </div>
        
        <div class="modal-footer-center">
          <button class="btn btn-secondary" onclick="closeModal('tableManagementModal')">Yopish</button>
        </div>
      </div>
    </div>

    <!-- Firebase SDK v10.7.1 - ES Modules -->
    <script type="module">
      // Firebase CDN modullarini oldindan yuklash
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
      import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
      console.log('âœ… Firebase SDK yuklandi');
    </script>

    <script type="module" src="src/js/main.js?v=20.0"></script>

</body>
</html>
